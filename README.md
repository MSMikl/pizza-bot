# pizza-bot
 
Telegram и Facebook боты для сети пиццерий

Основаны на списке московских пиццерий "Додо-пицца" и их меню.

При помощи бота можно выбирать пиццы для заказа, указывать место доставки, оплачивать заказ.

Backend магазина работает на сервисе https://www.elasticpath.com/

Дополнительно используется база **Redis** - можно воспользоваться бесплатной на сервисе https://redislabs.com/

Для распознавания адреса используется сервис https://yandex.ru/dev/maps/geocoder/ - также следует получить ключ

## Требования к установке

Необходим **Python** версии не ниже 3.5

Для бота необходимо получить токен в Телеграме, а также "привязать" оплату и получить платежный токен. Это делается через https://telegram.me/BotFather

Также необходмио создать собственный магазин в https://www.elasticpath.com/

Пароли и токены следует поместить в файл `.env`:

     STORE_ID = {Данные Elascticpath}
     CLIENT_ID = {Данные Elascticpath}
     CLIENT_SECRET = {Данные Elascticpath}
     TG_TOKEN = {Токен телеграм-бота}
     DB_HOST = {Данные Redislabs}
     DB_PORT = {Данные Redislabs}
     DB_PASS = {Данные Redislabs}
     YANDEX_API_KEY = {Ключ Яндекс.Геокодер}
     PAYMENT_TOKEN = {Токен оплаты Telegram}

Дополнительные параметры для Facebook

    FB_PAGE_ACCESS_TOKEN = {токен страницы Facebook}
    FB_VERIFY_TOKEN = {ключ для подтверждения Webhook}
    FLASK_HOST = {хост, на котором запускается webhook}
    FLASK_PORT = {порт, на котором запускается webhook}
    HTTP_PROXY = {прокси-сервер для обхода блокировки Facebook}

Для наполнения магазина товарами и адресами пиццерий можно использовать вспомогательные функции, расположенные в файле `main.py`.

Facebook-бот работает через `webhook`, поэтому необходимо организовать "проброс" хоста с ботом во внешнюю среду с постоянным URL. Можно использовать сервис https://ngrok.com/. Если есть собственный сервер с URL, то можно "пробросить" бота через обратный прокси.

## Запуск

Телеграм-бот запускается командой

    python tg_bot.py

Facebook-бот запускается командой

    python webhook.py
    
## Рабочий бот

Работающая версия телеграм-бота доступна по адресу https://t.me/pizzeria16_bot

Работающая версия Facebook-бота доступна в чате страницы https://www.facebook.com/profile.php?id=100084134066716


